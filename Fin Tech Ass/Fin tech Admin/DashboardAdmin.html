<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link rel="stylesheet" href="C:\Users\HP\vs code\Fin Tech ASS\Fin Tech Ass\dashboard.css">
    <script src="C:\Users\HP\vs code\Fin Tech ASS\Fin Tech Ass\chart.js"></script>
    <link rel="stylesheet" href="bootstrap-5.1.3-dist/bootstrap-5.1.3-dist/css/bootstrap.css">
    <link rel="stylesheet" href="C:\Users\HP\vs code\Fin Tech ASS\Fin Tech Ass\fontawesome-free-6.1.1-web/css/all.css">
   <script src="bootstrap-5.1.3-dist/bootstrap-5.1.3-dist/js/bootstrap.js"></script>
</head>
<body>
    <div class="container-fluid">
    
    <div class="flexs row" style="position:sticky;top: 0;">
    <nav class="navbar navbar-expand-sm navbar-dark ">
       
       <div class=" col-2  col-md-2 col-sm-2 mt-1">
         <span  style="margin-left:10px;">
            <img style="width:50px;height:50px;" src="C:\Users\HP\vs code\Fin Tech ASS\Fin Tech Ass\money bag3.png" alt="">
            <span>MoneyBag</span>
        </span>
       
        </div>
        <div class="col-md-1 col-sm-4">
        
            <!-- <input class="search collapse navbar-collapse w-50 w-md-75 w-sm-50"style="background-color:transparent;" type="search" placeholder="search"id="mynavbar"><i  class="fa-solid fa-search shadow "></i> -->
            
            <button  style="margin-left:80px;position:sticky;"class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mynavbar">
                <span class="navbar-toggler-icon"></span>
              </button>
        </div>
    
    <div class=" col-9 col-sm-6 col-md-9 collapse navbar-collapse" id="mynavbar">
        <input class="search w-50 w-md-75 w-sm-50"style="background-color:transparent;" type="search" placeholder="search"><i  class="fa-solid fa-search shadow "></i>
        <nav  class="navbar-nav me-auto sticky-top"style="">
        <a class="nav-link"style="color:white;text-decoration:none;" href="DashboardAdmin.html">
            <div class="links link-danger">Dashboard</div>
        </a><br>
        <a class="nav-link"style="color:white;text-decoration:none;" data-bs-toggle="modal" data-bs-target="#myModal3"href="">
            <div class="links">Add User</div>
        </a><br>
        <a class="nav-link" style="color:white;text-decoration:none;" href="password.html">
            <div class="links">Change Password</div>
        </a><br>
        
     </nav>
            <button onclick="confirm('are you sure you want to Log out?')" style="color:grey;margin-left:10px;text-decoration:none ;" class="border-0 bg-transparent">
        <a style="color:burlywood;text-decoration:none;" href="index.html">Log Out</a>
             </button>
        </div>
 
    </nav>
    
    </div>
  
    
        <div class="row">
         <form name="form1" method="get" action="Dashboard.html">
        <div id="name" style="background-color:aliceblue; color:black;width:100%;height:100px;margin-top:10px;"> 
            <br><span id="hello" style="font-size:30px;margin-left:10px;">Hello</span>
        </div>
        </form>
        </div>
    <div class="row">
    <div class="col-12 col-md-9 col-sm-12">
       <br>
       
        <div style="width:1000px !important;" class=" mt-5 mx-auto">
            
            <table class="table table-responsive-sm w-sm-100 w-md-12 w-12">
                <thead>
                    <th>S/N</th>
                    <th>Customer Name</th>
                    <th>Customer AccountNo</th>
                    <th>Customer Email</th>
                    <th>Transactions</th>
                    <th>Show Info</th>
                    <th>Edit Info</th>
                    <th>Delete</th>
                </thead>
                <tbody id="tab">

                </tbody>
            </table>

        
         </div>
    </div>

  
    <div class="col-12  col-md-3 col-sm-12 mt-5">
        <br>
        <div class=" shadow p-3 " style=" text-align:center;width:300px;height:200px;">
           <h3>CUSTOMERS</h3>
           <hr>
           <br>
           <h4 id="no"></h4>
        </div>
    </div>
    </div>
    </div>
    <!-- The Modal -->
    <div class="modal" id="myModal3">
        <div class="modal-dialog">
        <div class="modal-content">

            <!-- Modal Header -->
            <div class="modal-header">
            <h4 class="modal-title">Add User</h4>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>

            <!-- Modal body -->
               <div class="modal-body"style=" height:300px!important;overflow:auto!important;overflow-y:auto;overflow-x:none;">
                <div id="eds${s}">
                    <div class="row">
                <div class="col-8 mx-auto shadow mt-5 p-5">
                    <div>
                        <h3>User Info</h3>
                        <form action="">
                <span>Username</span><input  class="input form-control mb-1"id="getName"type="text">
                <span>Password</span><input class="input form-control mb-2" id="getPassword"type="text">
                <span>Email</span><input class="input form-control mb-2" id="getEmail"type="text">
                <span>Confirm Password</span><input class="input form-control mb-2"id="pawc" type="password">
                <button class="btn btn-success form-control mb-2"onclick="addUser()">Add</button>
                        </form>
                    </div>
            </div>
            </div>
                </div>
            <br>
            
            </div>

            <!-- Modal footer -->
            <div class="modal-footer">
            <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
            </div>

        </div>
        </div>
    </div>

    
    <script>
        //var sake=JSON.parse(localStorage.getItem("Database"));
      
        var soke;
        var take=JSON.parse(localStorage.getItem("DatabaseAmin2"));
        var takes=JSON.parse(localStorage.getItem("DatabaseAdmin"));
        var inner;
        if (JSON.parse(localStorage.getItem("Database"))){
            var sake=JSON.parse(localStorage.getItem("Database"));
            
           }
           else{
              var sake=[]
           }
        for (let i = 0; i < take.length; i++) {
             hello.innerHTML=take[i].username;
                
        }
        if ( JSON.parse(localStorage.getItem("Database"))) {
         soke=JSON.parse(localStorage.getItem("Database"));   
        
        for (let s = 0; s < soke.length; s++) {
            var w=s+1;
           
            tab.innerHTML+=`<tr id="delet${s}">
                            <td id="delete${s}">${w}</td>
                            <td id="pose${s}">${soke[s].username}</td>
                            <td>${soke[s].accountNo}</td>
                            <td id="pase${s}">${soke[s].email}</td>
                            <td><button onclick="trans(${s})" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#myModal" >show</button></td>
                            <td><button onclick="sh(${s})"class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#myModal2">show</button></td>
                            <td><button onclick="ed(${s})"class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#myModal1">edit</button></td>
                            <td><button onclick="del(${s})"class="btn btn-danger">delete</button></td>
                            </tr>
                            <!-- The Modal -->
                            <div class="modal" id="myModal2">
                                <div class="modal-dialog">
                                <div class="modal-content">

                                    <!-- Modal Header -->
                                    <div class="modal-header">
                                    <h4 class="modal-title">Customer Info</h4>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                    </div>

                                    <!-- Modal body -->
                                       <div class="modal-body"style=" height:300px!important;overflow:auto!important;overflow-y:auto;overflow-x:none;">
                                        <div id="shs${s}">
                                            
                                        </div>
                                    <br>
                                    
                                    </div>

                                    <!-- Modal footer -->
                                    <div class="modal-footer">
                                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
                                    </div>

                                </div>
                                </div>
                            </div>
                            
                                                <!-- The Modal -->
                            <div class="modal" id="myModal">
                                <div class="modal-dialog">
                                <div class="modal-content">

                                    <!-- Modal Header -->
                                    <div class="modal-header">
                                    <h4 class="modal-title">Transaction History</h4>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                    </div>

                                    <!-- Modal body -->
                                       <div class="modal-body"style=" height:300px!important;overflow:auto!important;overflow-y:auto;overflow-x:none;">
                                        <div id="rec${s}">
                                            
                                        </div>
                                    <br>
                                    
                                    </div>

                                    <!-- Modal footer -->
                                    <div class="modal-footer">
                                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
                                    </div>

                                </div>
                                </div>
                            </div>
                            <!-- The Modal -->
                            <div class="modal" id="myModal1">
                                <div class="modal-dialog">
                                <div class="modal-content">

                                    <!-- Modal Header -->
                                    <div class="modal-header">
                                    <h4 class="modal-title">Edit Board</h4>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                    </div>

                                    <!-- Modal body -->
                                       <div class="modal-body"style=" height:300px!important;overflow:auto!important;overflow-y:auto;overflow-x:none;">
                                        <div id="eds${s}">
                                            <div class="row">
                                        <div class="col-8 mx-auto shadow mt-5 p-5">
                                            <div>
                                                <h3>EDIT</h3>
                                                <form action="">
                                        <span>Username</span><input  class="input form-control mb-1"id="getName${s}"type="text">
                                        <span>Password</span><input class="input form-control mb-2" id="getPassword${s}"type="text">
                                        <span>Email</span><input class="input form-control mb-2" id="getEmail${s}"type="text">
                                        <span>Confirm Password</span><input class="input form-control mb-2"id="paw${s}" type="password">
                                        <button class="btn btn-success form-control mb-2"onclick="change(${s})">Change</button>
                                                </form>
                                            </div>
                                    </div>
                                    </div>
                                        </div>
                                    <br>
                                    
                                    </div>

                                    <!-- Modal footer -->
                                    <div class="modal-footer">
                                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
                                    </div>

                                </div>
                                </div>
                            </div>
          `
            
         } 
                   // tab.innerHTML=inner;
                }
                 no.innerHTML=sake.length;
                 window.change=function(s){
                    var poses="pose"+s;
                    var pases="pase"+s;
                    var lets=document.getElementById(poses).innerHTML;
                    let obj = sake.find(o => o.username === lets);
                    let q=sake.indexOf(obj);
                    alert(lets)
                     var getNames="getName"+s;
                     var getEmails="getEmail"+s;
                     var getPasswords="getPassword"+s;
                     var paws="paw"+s;
                     document.getElementById(poses).innerHTML=document.getElementById(getNames).value;
                     sake[q].username=document.getElementById(getNames).value;
                     document.getElementById(pases).innerHTML=document.getElementById(getEmails).value;
                     sake[q].emails=document.getElementById(getEmails).value;
                     
                     sake[q].password=document.getElementById(getPasswords).value;
                     
                     
                     localStorage.setItem("Database",JSON.stringify(sake));
                    
                 }
                 window.sh=function(s){
                    
                    var poses="pose"+s;
                    var let=document.getElementById(poses).innerHTML;
                    //alert(let)
                    let obj = sake.find(o => o.username === let);
                    let q=sake.indexOf(obj);
                   
                    var seen="shs"+s;
                    //alert(seen);
                    var inner1;
                  
                        
                        document.getElementById(seen).innerHTML+=`
                                 <div class=" mt-5 p-2 bg-light rounded text-dark">
                                <small>Balance:<i  class="fa-solid fa-naira-sign "></i>${sake[q].accBalance}</small><br>
                                <small>Username: ${sake[q].username}</small><br>
                                <small>Account No: ${sake[q].accountNo}</small><br>
                                <small>Email: ${sake[q].email}
                                    </small><br>
                                <small>Password:${sake[q].password}</small><br>
                                <br>
                                    </div>`
                  
            }
                window.trans=function(s){
                    
                    var poses="pose"+s;
                    var let=document.getElementById(poses).innerHTML;
                    alert(let)
                    let obj = sake.find(o => o.username === let);
                    let q=sake.indexOf(obj);
                    
                    var see="rec"+s;
                    alert(see);
                    for (let i = 0; i < sake[q].transaction.length; i++) {
                            inner+=`
                                <div class="p-2 bg-light rounded">
                                <small>${sake[q].transaction[i].action}</small><br>
                                <small>${sake[q].transaction[i].partner}</small><br>
                                <small>Account No: ${sake[q].transaction[i].acc}</small><br>
                                <small>Amount:<i  class="fa-solid fa-naira-sign"></i>${sake[q].transaction[i].amt}
                                    </small><br>
                                <small>Description:${sake[q].transaction[i].desc}</small><br>
                                <small>Balance:<i  class="fa-solid fa-naira-sign "></i>${sake[q].transaction[i].accBalance}</small><br>
                                <small>${sake[q].transaction[i].time}</small><br>
                                <button  onclick="deltrans(${i})"style="width:50px!important;font-size:12px!important;margin-left:200px;height:30px!important;" class="btn  bg-danger position p-0  mb-2 me-2 bottom-0 fs-6">delete</button></div>
                                
                        
                        
                                    </div>`
                    }
                          document.getElementById(see).innerHTML=inner;
            
            }
            function addUser(){

           var det;
           var i =0;
          
       
          
               for(i=0; i<=sake.length;i++)
               {
              
                
               if(JSON.parse(localStorage.getItem("Database"))){
                        var em=sake[i].email
                    }
                    else{
                        var em="";
                    }
                    if(getEmail.value==em){
                        response="This email already exist";
                        //alert(sake[i].email);
                        break;
                    }
                   else if(getPassword.value!=pawc.value){
                        response="Invalid password confirmation";
                        break;
                     }
                    else 
                    { 
                        let det={};
                        det.username=getName.value;
                        det.email=getEmail.value;
                        det.password=getPassword.value;
                        var ran=Math.random();
                        det.accountNo=Math.floor(ran*100000000); 
                        det.accBalance=5000;
                        console.log(det);
                        sake.push(det);
                        localStorage.setItem("Database",JSON.stringify(sake));
                        det=JSON.parse(localStorage.getItem("Database"));
                        
                        
                        response ="Registration succesfulliiii";
                        
                    
                        break;
                        
                    
               }
               
           }
           alert(response);
            }
            window.ed=function(s){
                    var inner="";
                    var poses="pose"+s;
                    var let=document.getElementById(poses).innerHTML;
                   // alert(let)
                    let obj = sake.find(o => o.username === let);
                    let q=sake.indexOf(obj);
                    
                    var see="eds"+s;
                    //alert(see);
                   
            
            }
            window.del=function(s){
                //alert(s)
                var k=s;
                var get ="delet"+s
                confirm("Are you sure you want to delete this record?")
                document.getElementById(get).innerHTML=" ";
              
                
                
                
               // window.reload()
                soke.splice(k,1)
                localStorage.setItem("Database",JSON.stringify(soke));
                tab.innerHTML=" "
                if (tab.innerHTML=" ") {
                    
                    
                    soke=JSON.parse(localStorage.getItem("Database"));
                    no.innerHTML=soke.length;
                    for (let s = 0; s < soke.length; s++) {
            var w=s+1;
        //    var inner=" ";
            tab.innerHTML+=`<tr id="delet${s}">
                            <td id="delete${s}">${w}</td>
                            <td id="pose${s}">${soke[s].username}</td>
                            <td>${soke[s].accountNo}</td>
                            <td id="pase${s}">${soke[s].email}</td>
                            <td><button onclick="trans(${s})" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#myModal" >show</button></td>
                            <td><button onclick="sh(${s})"class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#myModal2">show</button></td>
                            <td><button onclick="ed(${s})"class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#myModal1">edit</button></td>
                            <td><button onclick="del(${s})"class="btn btn-danger">delete</button></td>
                            </tr>
                            <!-- The Modal -->
                            <div class="modal" id="myModal2">
                                <div class="modal-dialog">
                                <div class="modal-content">

                                    <!-- Modal Header -->
                                    <div class="modal-header">
                                    <h4 class="modal-title">Customer Info</h4>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                    </div>

                                    <!-- Modal body -->
                                       <div class="modal-body"style=" height:300px!important;overflow:auto!important;overflow-y:auto;overflow-x:none;">
                                        <div id="rec1${s}">
                                            
                                        </div>
                                    <br>
                                    
                                    </div>

                                    <!-- Modal footer -->
                                    <div class="modal-footer">
                                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
                                    </div>

                                </div>
                                </div>
                            </div>
                            
                                                <!-- The Modal -->
                            <div class="modal" id="myModal">
                                <div class="modal-dialog">
                                <div class="modal-content">

                                    <!-- Modal Header -->
                                    <div class="modal-header">
                                    <h4 class="modal-title">Transaction History</h4>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                    </div>

                                    <!-- Modal body -->
                                       <div class="modal-body"style=" height:300px!important;overflow:auto!important;overflow-y:auto;overflow-x:none;">
                                        <div id="rec${s}">
                                            
                                        </div>
                                    <br>
                                    
                                    </div>

                                    <!-- Modal footer -->
                                    <div class="modal-footer">
                                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
                                    </div>

                                </div>
                                </div>
                            </div>
                            <!-- The Modal -->
                            <div class="modal" id="myModal1">
                                <div class="modal-dialog">
                                <div class="modal-content">

                                    <!-- Modal Header -->
                                    <div class="modal-header">
                                    <h4 class="modal-title">Edit Board</h4>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                    </div>

                                    <!-- Modal body -->
                                       <div class="modal-body"style=" height:300px!important;overflow:auto!important;overflow-y:auto;overflow-x:none;">
                                        <div id="eds${s}">
                                            <div class="row">
                                        <div class="col-8 mx-auto shadow mt-5 p-5">
                                            <div>
                                                <h3>EDIT</h3>
                                                <form action="">
                                        <span>Username</span><input  class="input form-control mb-1"id="getName${s}"type="text">
                                        <span>Password</span><input class="input form-control mb-2" id="getPassword${s}"type="text">
                                        <span>Email</span><input class="input form-control mb-2" id="getEmail${s}"type="text">
                                        <span>Confirm Password</span><input class="input form-control mb-2"id="paw${s}" type="password">
                                        <button class="btn btn-success form-control mb-2"onclick="change(${s})">Change</button>
                                                </form>
                                            </div>
                                    </div>
                                    </div>
                                        </div>
                                    <br>
                                    
                                    </div>

                                    <!-- Modal footer -->
                                    <div class="modal-footer">
                                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
                                    </div>

                                </div>
                                </div>
                            </div>
          `
            
         }
                
                }
                
               
            }
      

    </script>
</body>
</html>